---
output:
  # bookdown::word_document2
  bookdown::pdf_document2:
    toc: no
    number_sections: no
    pandoc_args: !expr rmdfiltr::add_wordcount_filter(rmdfiltr::add_citeproc_filter(args = NULL))
    latex_engine: xelatex
always_allow_html: true
header-includes:
# - \usepackage{setspace}\doublespace
  # - \usepackage{endnotes}
  # - \let\footnote=\endnote
  # - \usepackage{endfloat}
  # - \usepackage{fancyhdr}
  # - \pagestyle{fancy}
  # - \setlength{\headheight}{13.6pt}
  # - \rhead{\textit{N.I. Hoffmann}}
#  - \lhead{\textit{Draft. Please do not circulate.}}
editor_options: 
  chunk_output_type: console

citeproc: no
fontfamily: mathpazo
fontsize: 11pt
geometry: margin=1in
indent: yes
link-citations: yes
linkcolor: blue
lang: 'en-US'


bibliography: "My Library.bib"  
# csl: apa.csl
csl: american-sociological-association.csl

title: "Strangers in the Homeland? The Academic Performance of Children of Return Migrants in Mexico"
author: |
  | Nathan I. Hoffmann
  | Department of Sociology, UCLA

abstract: "The number of return migrants from the U.S. to Mexico has swelled in recent years, and yet we know little about the academic performance of the over 500,000 U.S.-born children who have accompanied them. This paper harnesses PISA test score data to compare U.S.-born children of return migrants in Mexico to two groups: Mexican-born students in Mexico, and students in the U.S. born to Spanish-speaking immigrant parents. Contrary to previous work highlighting the academic struggles faced by children of return migrants, these adolescents attain higher PISA scores than their Mexican-born counterparts. This advantage persists in models that control for both pre- and post-migration family characteristics. However, these adolescents' scores are much lower than similar youths in the U.S. Models that include controls suggest that selection of return migrant families accounts for part of this gap."

  
# date: "`r format(Sys.time(), '%B %e, %Y')`"
  
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F, message = F, cache = T)
options("yaml.eval.expr" = TRUE)

# library(flextable)
library(patchwork)
library(srvyr)
library(patchwork)
library(cem)
library(sandwich)
library(lmtest)
library(estimatr)
library(here)
library(knitr)
library(kableExtra)
library(broom)
library(haven)
library(tidyverse)

knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark=",")
})


options("yaml.eval.expr" = TRUE, scipen = 3, digits = 2)

uclablue = '#2774AE'
gray = '#808080'
black = '#000000'
ucla_palette = c(black, uclablue, gray)

# theme_set(theme_cowplot(font_family = 'Palatino') + 
theme_set(theme_classic(base_family = 'Palatino') + 
      theme(legend.title=element_blank(), 
         panel.grid.major.y = element_line('grey80'),
         legend.background = element_rect(fill = alpha("white", 0.5))
         ))
ggplot <- function(...) ggplot2::ggplot(...) + 
  scale_color_brewer(palette="Dark2") +
  scale_fill_brewer(palette="Dark2")

kable <- function(...) knitr::kable(..., format.args = list(big.mark = ","))
```

```{r load, include = F}
pisa_full <- readRDS(here('data', 'pisa.rds')) %>%
   filter(across(c(female,  mom_ed, dad_ed, early_ed, cultural_pos, home_ed, age),
                ~ !is.na(.x))) %>%
  mutate(school_id = paste0(year, school_id),
         village = school_location == 'Village',
         non_urban = ifelse(!is.na(school_location), school_location %in% c('Village', 'Small Town', 'Town'), NA))

pisa_mex <- pisa_full %>%
  filter(country == 'Mexico',
         birth_country %in% c('Mexico', 'United States of America'),
         mom_country == 'Mexico',
         dad_country == 'Mexico') %>%
  mutate(birth_country = ifelse(birth_country == 'United States of America', 'USA', as.character(birth_country)),
         treat = as.numeric(birth_country == 'USA'))

pisa_us <-  pisa_full %>%
  filter((country %in% c('United States', 'United States of America') & 
            birth_country == 'United States of America' &
            lang == 'Spanish' &
            mom_country == 'Another country (USA)' & 
            dad_country == 'Another country (USA)')) %>%
  mutate(country = 'USA',
         birth_country = 'USA')

pisa_mex_us <- bind_rows(
    filter(pisa_mex, birth_country == 'USA'),
    pisa_us
) %>%
  mutate(treat = as.numeric(country == 'Mexico'))


pisa_full %>%
  filter(country == 'Mexico',
         birth_country == 'United States of America',
         mom_country == 'Mexico', dad_country == 'Mexico') %>%
  mutate(birth_country = ifelse(birth_country == 'United States of America', 'USA', as.character(birth_country)),
         treat = as.numeric(birth_country == 'USA')) %>%
  nrow()
```

```{r functions}
rubin <- function(dataset, sample_label, covariates = NULL, pv_num = 5, 
                  treat = 'treat', weights = 'weight'){
  dataset = as.data.frame(dataset)
  dim_list <- list()
  method = ifelse(is.null(covariates), 'DIM', 'OLS')
  
  for(outcome in c('read', 'math', 'scie')){
    est_ols <- rep(NA, pv_num)
    var_ols <- rep(NA, pv_num)
    for(pv in 1:pv_num){
      if(is.null(covariates)){
        formula <- paste0(outcome, pv, ' ~ ', treat)
        } else{
          formula <- paste0(outcome, pv, ' ~ ', treat, ' + ', covariates)
        }
      lm_model <- lm(formula, data = dataset, weights = weight)
      est_ols[pv] <- tidy(lm_model)[[2,2]]
      var_ols[pv] <- vcovCL(lm_model, cluster = dataset$school_id)[2,2]
      #var_ols[pv] <- vcovHC(lm_model, type="HC1")[2,2]
    }
    est_out_ols <- mean(est_ols)
    var_samp_ols <- mean(var_ols)
    var_imp_ols <- sum((est_ols - est_out_ols)^2)/4
    se_out_ols <- sqrt(var_samp_ols + (1 + 1/5)*var_imp_ols)
    
    dim_list[[outcome]] <-
      data.frame(method = method,
                 sample = sample_label,
                 Outcome = outcome, 
                 Estimate = est_out_ols,
                 se = se_out_ols)
  }
  dim_list %>%
    bind_rows() %>%
    mutate(Outcome = recode_factor(Outcome,
                                 'read' = 'Reading',
                                 'math' = 'Math',
                                 'scie' = 'Science')) %>%
    return()
}

moderator_p <- function(df, cat1, cat2){
  out_list <- list()
  for(outcome in unique(df$Outcome)){
    b1 <- with(df, Estimate[sample == cat1 & Outcome == outcome])
    se1 <- with(df, se[sample == cat1 & Outcome == outcome])
    b2 <- with(df, Estimate[sample == cat2 & Outcome == outcome])
    se2 <- with(df, se[sample == cat2 & Outcome == outcome]) 
    
    z <- (b1 - b2)/sqrt(se1^2 + se2^2)
    p <- round(2*(1 - pnorm(abs(as.numeric(z)))), 3)
    
    out_list[[outcome]] <- data.frame(Outcome = outcome, dif = b1-b2, z = z, p = p)
  }
  return(bind_rows(out_list))
}
  
  

rubin_means <- function(dataset, labels = c(0,1), pv_num = 5, 
                  treat = 'treat', weights = 'weight', cluster_id = 'school_id'){
  dataset <- as_survey_design(dataset, 
                              ids = cluster_id,
                              weights = weights)
  mean_list <- list()
  
  for(outcome in c('read', 'math', 'scie')){
    mean_treat0 <- rep(NA, pv_num)
    mean_treat1 <- rep(NA, pv_num)
    var_treat0 <- rep(NA, pv_num)
    var_treat1 <- rep(NA, pv_num)
    
    for(pv in 1:pv_num){
      
      summary_df <- dataset %>%
        group_by(treat) %>%
        summarize(mean = survey_mean(!!sym(paste0(outcome, pv))),
                  var = survey_var(!!sym(paste0(outcome, pv))))
      
      mean_treat0[pv] <- summary_df[[1,2]]
      mean_treat1[pv] <- summary_df[[2,2]]
      
      var_treat0[pv] <- summary_df[[1,4]]
      var_treat1[pv] <- summary_df[[2,4]]
      
    }
    mean_out0 <- mean(mean_treat0)
    var_samp0 <- mean(var_treat0)
    var_imp0 <- sum((mean_treat0 - mean_out0)^2)/4
    sd_out0 <- sqrt(var_samp0 + (1 + 1/5)*var_imp0)
    
    mean_out1 <- mean(mean_treat1)
    var_samp1 <- mean(var_treat1)
    var_imp1 <- sum((mean_treat1 - mean_out1)^2)/4
    sd_out1 <- sqrt(var_samp1 + (1 + 1/5)*var_imp1)
    
    mean_list[[outcome]] <-
      data.frame(Outcome = outcome, 
                 label = c(labels[1], labels[2]),
                 n = c(nrow(filter(dataset, treat==0)), nrow(filter(dataset, treat==1))),
                 Mean = c(mean_out0, mean_out1),
                 SD = c(sd_out0, sd_out1)
                 )
  }
  mean_list %>%
    bind_rows() %>%
    mutate(Outcome = recode_factor(Outcome,
                                 'read' = 'Reading',
                                 'math' = 'Math',
                                 'scie' = 'Science')) %>%
    return()
}


stacked_bar <- function(data, x, fill){
  data %>%
    filter(!is.na(!!sym(x)) & !is.na(!!sym(fill))) %>%
    count(!!sym(x), !!sym(fill)) %>%
    ggplot(aes(x = !!sym(x), y = n, fill = !!sym(fill))) +
    geom_bar(position='fill', stat = 'identity') +
    theme(axis.text.x = element_text(angle = -30)) +
    labs(title = fill)
}

```



<!-- Despite decades of research into migration flows between Mexico and the U.S., the migration process of children -- including return and circular migration -- is only recently receiving concerted scholarly attention. A flurry of theoretical work on return and circular migrant children in Mexico has followed the calls of @orellana_2001_transnational and @dobson_2009_unpacking to center children in migration research.  -->


# Introduction

Despite an abundance of research on return migration, few studies focus on children of these returnees. @azose_2019_estimation estimate that the greatest number of return migrants in the world are from the United States to Mexico. Due to both rising deportations as well as economic recession [@durand_2019_evolution], 1.3 million Mexican migrants in the U.S. made the journey back to Mexico between 2010 and 2015 [@azose_2019_estimation]. Children of these Mexican return migrants now constitute a sizable population in Mexico, and yet they are only recently receiving scholarly attention. Estimates suggest that there are about 500,000 American-born minors in Mexico, constituting about 2 percent of school enrollment [@masferrer_2021_return, p. 39]. Following Víctor Zúñiga and colleagues [-@zuniga_2018_generation; @zuniga_2018_ninas; @zuniga_2021_children], I refer to these children as the "0.5 generation": children of Mexican immigrants who are born in the U.S. and later migrate to Mexico.  

Ethnographic work has provided intimate portraits of hundreds of these children in Mexico [@zuniga_2018_generation; @zuniga_2018_ninas; @zuniga_2021_children; @hamann_2006_pensando; @hernandez-leon_2020_imperfect; @despagne_2019_adaptation; @bybee_2020_estamos; @meyers_2014_outsiders; @bybee_2020_estamos]. Yet findings thus far present a mixed picture. Most of these studies emphasize the struggles that these children face in adapting to school in Mexico, such as difficulty with written language, invisibility to teachers, and stigma and exclusion from other youths. But not all research depicts these adolescents as strangers in their homeland. @despagne_2019_adaptation find that, over time, return migrant children are able to reposition themselves, capitalizing on their binational and bicultural assets to succeed in school. Other scholars recount that, despite these youths' challenges in adjusting to daily life in Mexico, teachers characterize them as "star students" in their academic achievement [@bybee_2020_estamos]. Because Mexico lacks national standardized testing [@santibanez_2021_contrasting], we do not know which findings generalize to the broader population of the 0.5 generation. Large-scale, nationally representative data are needed to determine whether the typical experience of these students is of academic advantage or disadvantage. Furthermore, if these children struggle in school, we do not know whether this is due to the challenges of migration or a process of selection of what families choose or are forced to migrate back to Mexico.  

To help answer these questions, this paper relies on the Programme for International Student Assessment (PISA) to characterize the educational achievement of U.S.-born children of return migrants in Mexico. PISA assesses 15-year-olds’ reading, math, and science skills every three years in dozens of countries worldwide [@schleicher_2019]. This paper makes two sets of comparisons. First, to assess the degree of integration or assimilation into their ancestral society, I compare U.S.-born children of return migrants to local non-migrants. Second, in a dissimilation analysis [@fitzgerald_2012_comparativist], I assess how these children's academic trajectories might have progressed had they not migrated, comparing these children to a counterfactual group of similar ones in the U.S. I also investigate the selection of return migrant parents and assess and how it may impact their children's achievement. <!-- how the educational situation of the 0.5 generation has changed over time.-->  

I find that previous studies have overstated the academic challenges faced by children of return migrants. Compared to Mexican adolescents, members of the 0.5 generation perform as well or better on PISA tests. These effect estimates are nearly identical in OLS models that control for pre- and post-migration attributes and those that do not. Furthermore, these effects vary little by gender, locality, or age at migration. On the other hand, dissimilation analyses show that the 0.5 generation obtains much lower scores than similar adolescents in the U.S. Although selection into migration accounts for some of the gap, disparities remain. Adolescents in Mexican rural areas obtain especially low scores, on average.  

These findings suggest that conclusions about the 0.5 generation depend heavily on the choice of reference group and showcase the strength of the dissimilation framework. Although these children struggle on PISA compared to their U.S. counterparts, they tend to perform as well or better than their Mexican classmates. In this sense, they are assimilating to the relatively low educational average of the under-resourced Mexican school system [@santibanez_2021_contrasting].



# Background
## Research Context
The Mexico-U.S. migration system has changed dramatically in the 21st century [@durand_2019_evolution]. After decades of high migration from Mexico to the U.S., the number of Mexican immigrants in the U.S. peaked at 12.8 million in 2007 and declined since, numbering 11.4 million in 2019 [@gonzalez-barrera_2021_covid19]. This fall is due both to lower rates of entry and rising rates of return [@durand_2019_evolution]. @gonzalez-barrera_2021_covid19 estimate that from 2005 to 2010, 1.39 million Mexican immigrants returned to Mexico from the U.S.; between 2009 and 2014, 1 million returned; and 710,000 returned between 2013 to 2018.^[Time periods overlap due to reliance on multiple datasets.]  

The bulk of return flows has been undocumented immigrants. From 2010 to 2018, 2.6 million undocumented Mexican immigrants returned to Mexico [@warren_2020_reverse]. A rapid increase in deportations is responsible for a large part of this outflow [@durand_2019_evolution, p. 37], but @warren_2020_reverse highlights that 45 percent of undocumented Mexican immigrants returned voluntarily. Precarious economic conditions in the U.S. and a stabilizing Mexican economy have increased incentives to return [@gonzalez-barrera_2021_covid19].  

Changing economic conditions and U.S. policy have led to a shift in the composition of Mexican return migrants. @campos-vazquez_2012_selfselection find a shift from positive to negative selection when compared to the full Mexican population: in 1990, return migrants had more years of schooling and higher wages than their stay-at-home compatriots, whereas in 2010 they tended to have less schooling and earn lower wages. @parrado_2016_changing argue that the lower wages of return migrants in 2010 compared to 1990 and 2000 are due to the less voluntary nature of return migration in recent years, and they also find decreases in entrepreneurship and the ability to remain inactive. For deportees, accumulation of valuable skills and capital is cut short [@cassarino_2004_theorising]. Using data from 2011 to 2013, @diaz_2016_moving show that negative selection also characterizes comparisons to Mexican immigrants who stay in the U.S.: return migrants are less likely to possess a high school or college degree.  

Children are absent from most discussions of return migration, yet their numbers are significant. In 2000, the Mexican census counted 258,000 U.S.-born minors; by 2010, this had more than doubled to 570,000 [@masferrer_2019_immigrants]. This number has remained steady in the years since: the 2020 Mexican census reports that about 500,600 minors, or about 2 percent of the school-age population, were born in the U.S. [@masferrer_2021_return, p. 39].  

A flurry of theoretical work on return migrant children in Mexico has followed the calls of @orellana_2001_transnational and @dobson_2009_unpacking to center children in migration research. Early work conceptualizing "(transnational) sojourner students" [@hamann_2001_theorizing; @hamann_2006_pensando] led to a large-scale survey in Nuevo León, Zacatecas, Puebla, and Jalisco to identify hundreds of students who had been born or had spent significant time in the U.S. [@zuniga_2018_generation; @zuniga_2018_ninas; @zuniga_2021_children]. This research team dubs this population the "0.5 generation." Like the "1.5 generation" label for children who migrate at a young age [@portes_2001a], "0.5 generation" foregrounds liminality; they cannot be easily grouped with either the native-born "0 generation" or the "first generation" of migrants more broadly, and this in-betweenness contributes to their particular challenges navigating an education system and society that feels both familiar and foreign.^[While Zúniga and colleagues include minors born in Mexico but who migrated to the U.S. at an early age as well as those born in the U.S., I more narrowly apply the "0.5 generation" label only to those born in the U.S.]

<!-- regardless of their place of birth, these children have experience abroad but currently reside in the country of their parents' birth. -->
<!-- Noticing that Mexican adult respondents in Georgia often held plans to return to Mexico with their children -- many of them U.S.-born -- Hamann [-@hamann_2001_theorizing, p. 32] defined a new category, "sojourner student," whose "two defining characteristics are their vulnerability to dislocation and their transnational background."  -->

The findings from the studies by Zúñiga, his colleagues, and other researchers working in this domain have been mixed. Much of this work emphasizes the difficulties that the 0.5 generation faces in the Mexican "homeland." Despite usually possessing oral proficiency in both Spanish and English, their written competency often lags behind [@gonzalez_2016_moving; @despagne_2019_adaptation; @gandara_2020_students; @santibanez_2021_contrasting]. Especially when they first arrive, peers often treat them as outsiders [@meyers_2014_outsiders], and the stigma they face can be exacerbated by political climate, such as the 2016 election [@bybee_2020_estamos]. Such conflicts occur psychologically as well, as these children struggle with their identity and feelings of belonging [@despagne_2019_adaptation; @bybee_2020_estamos]. Yet their appearance and oral fluency often renders them invisible to teachers [@sanchezgarcia_2016_educator], and resources for immigrant students are lacking in Mexico [@santibanez_2021_contrasting]. Even navigating the complicated bureaucracy to enroll in school or finding the money for transportation, uniforms, and school supplies may be out of reach for return migrant families [@gandara_2020_students]. Finally, family separation is a frequent, stressful feature of migration that is common for the 0.5 generation as well [@gonzalez_2016_moving; @zuniga_2018_generation].  

Yet not all work on return migrant children conceives of them as consigned to disadvantage. @zuniga_2018_ninas and @hernandez-leon_2020_imperfect see some of the children in their study benefiting from dual nationality. Similarly, in an intensive ethnography in central Mexico, Bybee et al. [-@bybee_2020_estamos, p. 135] observe a "star student" discourse: "The notion of American-Mexican pupils as “good students” was common enough in both schools that it extended beyond English classes where they had an obvious advantage." Although these students experienced bullying and exclusion due to their perceived foreignness, the privilege of a binational education and resources gave some of them a leg up in school.  


## Theories

How can we understand understand the mixed results from previous studies of the 0.5 generation in Mexico? Work on the 0.5 generation has not fully engaged with theories of return migrant integration more broadly, yet these theories can help explain both positive and negative outcomes of their U.S.-born children. In an influential review, @cassarino_2004_theorising attempts to synthesize theories of return migration into a more flexible, general theory. While early neoclassical economic theory assumes that return migration marks a failure to achieve one's goals [@todaro_1980], the New Economics of Labor Migration (NELM)  considers return migration as evidence of *success* [@stark_1985]: when a migrant saves or remits adequate funds, return may be the next step in the plan. Structural theories, on the other hand, suggest that institutional opportunities in the country of origin matter too: return happens when these appear hospitable [@cerase_1974_expectations].  

Transnationalism breaks the origin-destination dichotomy present in the other theories by conceiving of return migration as part of a circular system [@portes_1999a; @basch_1994_nations]. Migrants may feel connected by common ethnicity to a multipolar diaspora, developing identity with the host and home countries. Upon return, they may experience alienation and marginalization, strengthening their transnational identities. Finally, Cassarino discusses network theorists. Unlike transnationalists, they do not view ties between migrants as given, but shaped by strategic linkages and interpersonal experiences. Varying degrees of network embeddedness are possible, and social structure shapes returnees' success in their initiatives.  

In his resource mobilization-preparedness framework, @cassarino_2004_theorising attempts to integrate these theories and more explicitly incorporate forced return. Resource mobilization refers to the tangible and intangible resources (including social capital) that a person gains during the migration experience. Preparedness, on the other hand, encompasses to a migrant's readiness and willingness to return. Migrants who are prepared to return *and* have acquired significant resources while abroad are likely to succeed in the home country. On the other hand, migrants who mobilize few resources and are not prepared for return -- as is often the case with deportees -- are more susceptible to economic hardship and marginalization in the home country.  

Despite its strength in explaining both positive and negative return outcomes, Cassarino's theory does not develop a role for origin-country context. In their review of sociological studies of return migration, @hagan_2020_return make a corrective: "We argue that reintegration pathways of return migrants depend not only on (a) the accumulation of resources and (b) readiness for return, as argued by Cassarino, but also on (c) sending state, institutional, and family contexts of reception and (d) opportunities to mobilize resources in local economies to which migrants return." In an origin context that stigmatizes return migrants, or where the institutions for capital and skill investment are lacking, the children that accompany them are likely to suffer, regardless of individual resources. 


## Empirical Expectations

These frameworks highlight the variety of experiences that children in the 0.5 generation might have. First, they help us understand possible *disadvantage* for the 0.5 generation. The perspective of neoclassical economics suggests that return migrant families have not found lucrative employment in the host country. Even in cases where they have, the transnationalist perspective emphasizes that alienation and exclusion in the "home" society can still afflict return migrants and their children. Institutions for investment and activation of resources gained in the U.S. may also be lacking [@hagan_2020_return, p. 539]. In addition, migrants who are not ready and willing to migrate -- as in the case of deportation -- are less likely to possess the resources to ease re-entry into Mexican society. The result can be traumatic for children, and may give rise to the difficulties documented in the ethnographic research cited above. These expectations lead to what I call the *rough re-entry hypothesis*:

> Compared to Mexican-born children in Mexico, children of return migrant children attain lower PISA scores. 


Yet the 0.5 generation may also be among the privileged in Mexico. The NELM perspective highlights how voluntary return migration can be evidence of economic success, with parents accumulating sufficient resources to lead a comfortable life in Mexico. Following Cassarino's theory, if children benefit from resource-rich social networks and parents who have achieved their goals in acquiring skills and capital while abroad, and if the family is ready and willing to migrate, they are more likely to be well supported upon return to their parents' country of origin. As mentioned above, some scholars suggest that these children may benefit from resources including dual nationality, bicultural facility, and experience in better resourced schools [@gandara_2021_students]. The "star student discourse" documented by @bybee_2020_estamos and resulting from institutional, rather than individual, resources, leads to what I call the *star student hypothesis*:

> Compared to Mexican-born children in Mexico, children of return migrant children attain higher PISA scores. In models adjusting for family resources, this disparity remains. 


If the rough re-entry hypothesis is correct, then these students' challenges may be connected to return-migrant selection. For return migrants from the U.S. to Mexico, negative selection on characteristics such as education and income has predominated in recent years [@campos-vazquez_2012_selfselection; @parrado_2016_changing]. Observing which migrant families both voluntarily and voluntarily return to Mexico, Hernández-León et al. [-@hernandez-leon_2020_imperfect, p. 94] suggest that "U.S. policies [...] effectively externalize downward assimilation to communities of origin." Migrants who return to Mexico from the U.S. may be those having the roughest time in the host country; hence their children are a selected group, more likely to struggle in the homeland due to disadvantage accrued before return. Furthermore, less-educated migrant parents are less likely to find lucrative work and more likely to be targeted for deportation. I call this third set of expectations the *negative selection hypothesis*: 

> Compared to children of Spanish-speaking immigrants in the U.S., children of return migrant children in Mexico attain lower PISA scores. However, in models adjusting for family background and resources, this disparity diminishes.  







# Data

Data for the preliminary results below come from the pooled 2012, 2015, and 2018 waves of PISA. As shown in Table \@ref(tab:stats), my sample of interest comprises `r count(filter(pisa_mex, birth_country == 'USA'))` children in Mexico who were born in the U.S. to two Mexican-born parents. I compare these to `r count(filter(pisa_mex, birth_country == 'Mexico'))` children born in Mexico to two Mexican-born parents as well as `r nrow(pisa_us)` children born to two Spanish-speaking immigrant parents in the U.S. Although PISA data for the U.S. do not include exact country of birth for parents, about two-thirds of the Hispanic population in the U.S. is of Mexican origin [@trevelyan_2016_characteristics, p. 12], rendering this an appropriate pseudo-control group.  

Outcome variables consist of reading, math, and science scores, which the OECD constructs to have a global mean of 500 and standard deviation of 100. I use the first five plausible values for reading, math, and science scores, combining estimates and calculating standard errors as suggested by the PISA Technical Reports.^[Although the 2015 and 2018 waves of PISA contain 10 plausible values, the 2012 data contains only 5.] I also cluster HC1 standard errors at the school level and incorporate final sampling weights in all analyses.  

Pre-migration control variables include mother's and father's education (measured in 6-category ISCED, entered as a continuous variable), cultural possessions, home educational resources, age, a categorical variable for early childhood education and care (ECEC), survey year, and two-category gender. I also consider post-migration variables as possible mediators. These include composite variables constructed by the OECD which I standardize to have a mean of 0 and standard deviation 1 within waves: household wealth, home possessions, home information and communication technology (ICT) resources, and an index of economic, social and cultural status. I also include highest parental occupational status measured in the International Socio-Economic Index [@ganzeboom_1992_standard] and a dichotomous measure of urban locality, with one category for small and large cities and another for villages, small towns, and towns.




```{r stats}
bind_rows(
  rubin_means(pisa_mex, labels = c('Mexico', 'U.S.')) %>%
    mutate(Country = 'Mexico') %>%
    select(Outcome, Country, `Birth Country` = label, n, Mean, SD),
  rubin_means(pisa_mex_us, labels = c('U.S.', 'Mexico')) %>%
    filter(label == 'U.S.') %>%
    mutate(`Birth Country` = 'U.S.') %>%
    select(Outcome, Country = label, `Birth Country`, n, Mean, SD)
  )  %>% 
  select(-SD) %>% 
  pivot_wider(names_from = Outcome, values_from = Mean) %>%
  kable(booktabs = T, linesep = "",
        caption = 'Sample sizes and PISA score means. The Mexico country, U.S. birth country sample includes only children of Mexican immigrants. The U.S. country, U.S. birth country sample includes only children born to Spanish-speaking immigrant parents. Mean estimates incorporate sampling weights and account for clustering within schools.') %>%
  footnote(general = 'PISA data for 2012, 2015, and 2018. Author\'s calculations.',
           general_title = 'Source:',
           threeparttable = T,
           footnote_as_chunk = T)
  
  # df %>%
#   arrange(Outcome) %>%
#   pivot_wider(names_from = 'Outcome', values_from = c('Mean', 'SD')) %>%
#   flextable() %>%
#   add_header_row(colwidths = c(3,2,2,2), values = c('', 'Reading', 'Math', 'Science'))
  
  
  # bind_rows(
  # pisa_mex %>%
  #   group_by(country, birth_country) %>%
  #   summarize(n = n(),
  #             Reading = mean(read1),
  #             `Reading SD` = sd(read1),
  #             Math = mean(math1),
  #             `Math SD` = sd(math1),
  #             Science = mean(scie1),
  #             `Science SD` = sd(scie1)),
  # pisa_us %>%
  #   group_by(country, birth_country) %>%
  #   summarize(n = n(),
  #             Reading = mean(read1),
  #             `Reading SD` = sd(read1),
  #             Math = mean(math1),
  #             `Math SD` = sd(math1),
  #             Science = mean(scie1),
  #             `Science SD` = sd(scie1))) %>%
  # rename(`Birth Country` = birth_country,
  #        Country = country) %>%
```


# Methods

For the 0.5 generation, how do we define "positive" or "negative" outcomes in school? Much depends on the comparison group and estimand [@lundberg_2021_what]. The default comparison group for nearly all studies of immigrant education are locals without a migration background. Such a comparison is useful because it alerts policymakers and educators to disparities that can have lasting impacts on inequality. Yet such a perspective also ignores immigrant selection. As discussed above, the composition of Mexican return migrants has transformed dramatically in the face of changing economics and immigration policy in the U.S. Such immigrant selection has important implications for their children's education. Feliciano [-@feliciano_2005; @feliciano_2017] shows that the children of immigrants with more education than their stay-at-home compatriots -- a phenomenon often called "positive selection" -- tend to excel in school. Yet we know little about the impact of immigrant selection on children's schooling in the context of return migration.  

Immigrant selection can be incorporated into statistical models of children's education in two ways. It can be directly included as a covariate measuring relative educational attainment, at either the group [@feliciano_2005] or individual [@feliciano_2017] level. Alternatively, the researcher can find a suitable comparison group that implicitly accounts for immigrant selection. For example, @hoffmann_2020_winwin compares young Eastern European migrants in Western Europe to similar co-nationals who stayed behind in the East. This second approach has the benefit of accounting for more than measured educational selectivity: many skills are not captured by measures of formal education [@hagan_2015], and immigrants are selected in ways not related to skills at all.  

This paper makes both types of comparisons. First, it places U.S.-born children of Mexican return migrants in the Mexican educational context by comparing them to local Mexican children without migration backgrounds, providing an estimate of the descriptive gap in achievement between locals and the 0.5 generation. This set of analyses follows in the tradition of assimilation literature, showing how similar to locals these migrant children have become. Second, it compares these children to a suitable group in the U.S.: Spanish-speaking children of immigrants in the U.S. The goal here is a causal estimand: the scores these children would have obtained in the U.S. had they not migrated to Mexico. These results quantify the phenomenon of "dissimilation": while assimilation refers to a process of becoming more similar to locals, dissimilation describes how immigrants become different from those they left behind [@fitzgerald_2012_comparativist]. Finally, this paper explicitly examines immigrant selection by comparing and incorporating attributes of parents of these children in Mexico and the U.S.

I present difference-in-means and OLS regression estimates comparing children of Mexican return migrants to both the Mexican and U.S. comparison samples. I incorporate pre-migration and post-migration attributes in turn as covariates in the OLS regressions to examine selection and integration processes. I also test the influence of the potential moderators of gender, rural/urban location, and age at migration by perform OLS regressions on subsets of the data.

<!-- For the Mexican-born sample, I also perform coarsened exact matching (CEM) using the automatic coarsening algorithm from the `cem` package in R [@iacus_2012]. The U.S. comparison sample is too small for coarsened exact matching. -->





# Results

## Assimilation to the Mexican Context

The first set of analyses compares the 0.5 generation to local children in Mexico. Table \@ref(tab:stats) presents sample sizes, mean scores, and standard deviations for the three samples. Although mean scores for all groups in the table are below the global average of 500, U.S.-born children in Mexico tend to score somewhat higher than Mexican-born children, especially in math.  



```{r models, include = F, results = 'hide'}



## DIM and OLS
# dim_list <- list()
# datasets <- list(pisa_mex, pisa_mex_us)
# samples <- c('Mexico', 'USA')
# 
# for(i in 1:2){
#   for(outcome in c('read', 'math', 'scie')){
#     est_dim <- rep(NA, 5)
#     var_dim <- rep(NA, 5)
#     est_ols <- rep(NA, 5)
#     var_ols <- rep(NA, 5)
#     est_ols2 <- rep(NA, 5)
#     var_ols2 <- rep(NA, 5)
#       for(pv in 1:5){
#         dim <- difference_in_means(formula(paste0(paste0(outcome, pv), '~ treat')), 
#                                              data = datasets[[i]])
#         est_dim[pv] <- dim$coefficients
#         var_dim[pv] <- (dim$std.error)^2
#         
#         lm_model <- 
#          lm(paste0(paste0(outcome, pv), '~ treat + mom_ed + dad_ed + female + early_ed +
#               cultural_pos + home_ed + age + year'), data = datasets[[i]])
#         
#             est_ols[pv] <- tidy(lm_model)[[2,2]]
#             var_ols[pv] <- vcovHC(lm_model, type="HC1")[2,2]
#             
#         lm_model_post <- 
#          lm(paste0(paste0(outcome, pv), '~ treat + mom_ed + dad_ed + female + early_ed +
#               cultural_pos + home_ed + age + year + non_urban +
#               wealth + home_pos + ict_res + escs + parent_isei'), data = datasets[[i]])
#         
#             est_ols2[pv] <- tidy(lm_model_post)[[2,2]]
#             var_ols2[pv] <- vcovHC(lm_model_post, type="HC1")[2,2]            
#       }
#     
#     est_out_dim <- mean(est_dim)
#     var_samp_dim <- mean(var_dim)
#     var_imp_dim <- sum((est_dim - est_out_dim)^2)/4
#     se_out_dim <- sqrt(var_samp_dim + (1 + 1/5)*var_imp_dim)
#     
#     dim_list[[paste0(i, outcome, 'dim')]] <-
#       data.frame(sample = samples[i], 
#                  method = 'DIM',
#                  Outcome = outcome, 
#                  Estimate = est_out_dim,
#                  se = se_out_dim)
#     
#     est_out_ols <- mean(est_ols)
#     var_samp_ols <- mean(var_ols)
#     var_imp_ols <- sum((est_ols - est_out_ols)^2)/4
#     se_out_ols <- sqrt(var_samp_ols + (1 + 1/5)*var_imp_ols)
#     
#     dim_list[[paste0(i, outcome, 'ols')]] <-
#       data.frame(sample = samples[i],
#                  method = 'OLS',
#                  Outcome = outcome, 
#                  Estimate = est_out_ols,
#                  se = se_out_ols)
#     
#     est_out_ols2 <- mean(est_ols2)
#     var_samp_ols2 <- mean(var_ols2)
#     var_imp_ols2 <- sum((est_ols2 - est_out_ols2)^2)/4
#     se_out_ols2 <- sqrt(var_samp_ols2 + (1 + 1/5)*var_imp_ols2)
#     
#     dim_list[[paste0(i, outcome, 'ols2')]] <-
#       data.frame(sample = samples[i],
#                  method = 'OLS (post-migration)',
#                  Outcome = outcome, 
#                  Estimate = est_out_ols2,
#                  se = se_out_ols2)
#   }
# }

cem_out <- MatchIt::matchit(treat ~ mom_ed + dad_ed + female + early_ed +
                            cultural_pos + home_ed + age + year,
                            data = pisa_mex,
                            method = 'cem',
                            s.weights = pisa_mex$weight)
cem_data <- MatchIt::match.data(cem_out)

dim_fig_mex <-
  bind_rows(rubin(pisa_mex, 'DIM'),
          rubin(pisa_mex, 'OLS (pre-migration)', 'mom_ed + dad_ed + female + early_ed +cultural_pos + home_ed + age + year'),
          # rubin(cem_data, 'CEM', 
          #       'mom_ed + dad_ed + female + early_ed +cultural_pos + home_ed + age + year',
          #       weights = 'weights'),
          rubin(pisa_mex, 'OLS (pre- & post-migration)',
                covariates = 'mom_ed + dad_ed + female + early_ed +
                cultural_pos + home_ed + age + year + non_urban +
                wealth + home_pos + ict_res + escs + parent_isei')
) %>%
  mutate(Outcome = recode_factor(Outcome,
                                 'read' = 'Reading',
                                 'math' = 'Math',
                                 'scie' = 'Science'),
            sample = factor(sample, 
                            levels = c('DIM', 'OLS (pre-migration)', 'OLS (pre- & post-migration)')))









## CEM
# vars <- c('mom_ed', 'dad_ed', 'female', 'early_ed', 'cultural_pos', 
#           'home_ed', 'age', 'year') 
# cem_data <- pisa_mex %>%
#   filter(across(c(female,  mom_ed, dad_ed, early_ed, cultural_pos, home_ed, age, treat),
#                                ~ !is.na(.x))) %>%
#   as.data.frame()
# cem_out <- cem(treatment = 'treat', 
#                data = cem_data[c(vars, 'treat')],
#                eval.imbalance = F)
# 
# cem_list <- list()
# for(outcome in c('read', 'math', 'scie')){
#   est <- rep(NA, 5)
#   var <- rep(NA, 5)
#   for(pv in 1:5){
#     cem_est <- MatchIt::matchit(as.formula(paste0(paste0(outcome, pv), ' ~ treat')),
#                                 data = cem_data,
#                                 method = 'cem',
#                                 s.weights = weight)
#     # cem_est <- att(cem_out, 
#     #                as.formula(paste0(paste0(outcome, pv), ' ~ treat')), 
#     #                data = cem_data,)
#     est[pv] <- cem_est$att.model[1,2]
#     var[pv] <- (cem_est$att.model[2,2])^2
#   }
#   
#   est_out <- mean(est)
#   var_samp <- mean(var)
#   var_imp <- sum((est - est_out)^2)/4
#   se_out <- sqrt(var_samp + (1 + 1/5)*var_imp)
#   
#   cem_list[[outcome]] <-
#     bind_rows(
#       data.frame(sample = 'CEM',
#                Outcome = outcome,
#                Estimate = est_out,
#                se = se_out))
#       # data.frame(spec = 'CEM Extrapolated',
#       #            Outcome = outcome,
#       #            Estimate = cem_est_ex$att.model[1,1],
#       #            se = cem_est_ex$att.model[2,1]))
# }

# dim_fig_mex <- bind_rows(models_df_mex, bind_rows(cem_list)) %>%
#   mutate(Outcome = recode_factor(Outcome,
#                                  'read' = 'Reading',
#                                  'math' = 'Math',
#                                  'scie' = 'Science'),
#             sample = factor(sample, 
#                             levels = c('DIM', 'OLS', 'CEM', 'OLS (post-migration)')))





# dim_fig <- bind_rows(bind_rows(dim_list), bind_rows(cem_list)) %>%
#     mutate(Outcome = recode_factor(Outcome,
#                                  'read' = 'Reading',
#                                  'math' = 'Math',
#                                  'scie' = 'Science'),
#             method = factor(method, 
#                             levels = c('DIM', 'OLS', 'CEM', 'OLS (post-migration)')),
#             sample = factor(sample, levels = c('Mexico', 'USA')))
#                        # levels = c("Mexico DIM", "Mexico OLS", "Mexico CEM", "USA DIM", "USA OLS")))

```

```{r dim-mex, results = 'hide', fig.height = 3.5, fig.cap = "Difference-in-means (DIM), OLS, and coarsened exact matching (CEM) estimates, comparing children of return migrants in Mexico to children in Mexico. Error bars represent 95% asymptotic confidence intervals. OLS models parents' education, cultural possessions, home educational resources, age, ECEC, gender, and survey year. OLS (post-migration) models additionally adjust for household wealth; home possessions; home ICT resources; an index of economic, social and cultural status; urban or non-urban locality; and highest parental ISEI. All models cluster standard errors at the school level and incorporate sampling weights."}
dim_fig_mex %>%
  ggplot(aes(x = sample, y = Estimate, color = Outcome)) +
  geom_point(position = position_dodge(0.2)) +
  geom_errorbar(aes(ymin = Estimate - 1.96*se, ymax = Estimate + 1.96*se),
                width = 0, alpha = 1, position = position_dodge(0.2)) +
  geom_hline(yintercept = 0) +
  labs(x = '', y = 'Estimated difference in PISA score') +
  theme(#axis.text.x=element_text(angle=-15),
        legend.justification=c(1,0), 
        legend.position=c(.4,.7))



```

Figure \@ref(fig:dim-mex) compares PISA scores of children of return migrants in Mexico to the local Mexican-born sample using difference-in-means (DIM) and ordinary least squares (OLS). The error bars show 95-percent asymptotic confidence intervals. We first consider the DIM estimates, which subtract the average reading, math, or science scores for children of return migrants from the scores for the comparison group. Compared to other adolescents in Mexico, children of return migrants perform somewhat better in all three subjects. The difference amounts to `r with(dim_fig_mex, Estimate[sample == 'DIM' & Outcome == 'Reading'])` in reading, `r with(dim_fig_mex, Estimate[sample == 'DIM' & Outcome == 'Math'])` in math, and `r with(dim_fig_mex, Estimate[sample == 'DIM' & Outcome == 'Science'])` in science. Although the differences are not significant for reading and science, the math advantage is highly significant and reaches one-fifth of a standard deviation. The next set of estimates adjust for pre-migration characteristics in a linear regression estimated by OLS. The advantage for each score does not diminish and is more precisely estimated. The 0.5 generation performs as well as or better than similar Mexican-born children, especially in math.


<!-- I test the robustness of these results by applying coarsened exact matching (CEM), which matches `r cem_out$tab[2,2]` of the children of return migrants to `r cem_out$tab[2,1]` locals. Point estimates nearly double and the difference for reading becomes significant, but the difference for science scores loses significance.  -->


These results are contrary to the rough re-entry hypothesis suggested by most previous work on return migrant children's experiences: rather than struggling academically, these children are doing at least as well or better than the general population of Mexican-born children. Hence the data support the star student hypothesis: despite the travails of migration, these children are not academically disadvantaged compared to their Mexican peers, attaining somewhat higher scores.

The third set of estimates, "OLS (post-migration)", includes possible post-migration mediators of the advantage possessed by members of the 0.5 generation. These include household wealth; home possessions; home information and communication technology (ICT) resources; an index of economic, social and cultural status; urban or non-urban locality; and highest parental occupational status (in ISEI). The academic advantaged enjoyed by the 0.5 generation does not diminish and is estimated more precisely. These models suggest that material circumstances do not account for these children's higher scores. It seems more likely that institutional advantages of a bicultural education, better resourced U.S. schools, and potential dual nationality have provided these children with advantages to succeed in school.  


```{r mod-desc-mex, fig.cap = 'Sample distributions of gender, school location, and age at arrival. The first two panels compare the U.S.-born 0.5 generation to Mexican-born locals, while the third panel shows the distribution only for the 0.5 generation. All estimates incorporate sampling weights.'}
plot_female <- pisa_mex %>%
  group_by(treat) %>%
  count(female, wt = weight) %>%
  mutate(treat = ifelse(treat == 1, "0.5 gen.", "Mexico"),
         female = ifelse(female == 1, 'Female', 'Male')) %>%
  ggplot(aes(x = treat, y = n, fill = female)) +
  geom_bar(position='fill', stat = 'identity') +
  geom_text(aes(label = female), size = 3, 
            position = position_fill(vjust = 0.5), color = 'white') +
  labs(x = '', y = 'Proportion', 
       title = 'Gender') + 
  theme(legend.position = "none")

plot_location <- pisa_mex %>%
  filter(!is.na(school_location)) %>%
  group_by(treat) %>%
  count(school_location, wt = weight) %>%
  mutate(treat = ifelse(treat == 1, "0.5 gen.", "Mexico")) %>%
  ggplot(aes(x = treat, y = n, fill = school_location)) +
  geom_bar(position='fill', stat = 'identity') +
  geom_text(aes(label = school_location), size = 2.5,
            position = position_fill(vjust = 0.5), color = 'white') +
  labs(x = '', y = '', 
       title = 'School Location') + 
  theme(legend.position = "none")

age_arrival_df <- pisa_mex %>%
  filter(treat == 1, !is.na(age_arrival)) %>%
   count(age_arrival, wt = weight) %>%
  mutate(prop = n /sum(.[,'n']))

plot_age_arrival <- age_arrival_df %>%
  ggplot(aes(x = age_arrival, y = prop)) +
  geom_col(width = .99) +
  labs(x = '', y = '', 
       title = 'Age at Arrival')

plot_female + plot_location + plot_age_arrival
```

```{r mod-est-mex-mods}
controls = '+ mom_ed + dad_ed + female + early_ed + cultural_pos + home_ed + age + year'

mod_df_mex <- bind_rows(
  rubin(filter(pisa_mex, female == 1), 'Girls', covariates = controls),
  rubin(filter(pisa_mex, female == 0), 'Boys', covariates = controls),
  rubin(filter(pisa_mex, non_urban == 1), 'Non-urban', covariates = controls),
  rubin(filter(pisa_mex, non_urban == 0), 'Urban', covariates = controls),
  rubin(filter(pisa_mex, village == 1), 'Village', covariates = controls),
  rubin(filter(pisa_mex, village == 0), 'Non-village', covariates = controls),
  rubin(filter(pisa_mex, age_arrival < 5 | treat == 0), 'Under 5', covariates = controls),
  rubin(filter(pisa_mex, age_arrival >= 5 | treat == 0), '5 and older', covariates = controls),
  rubin(filter(pisa_mex, age_arrival < 10 | treat == 0), 'Under 10', covariates = controls),
  rubin(filter(pisa_mex, age_arrival >= 10 | treat == 0), '10 and older', covariates = controls)
)



# moderator_p(mod_df_mex, 'Girls', 'Boys')
# moderator_p(mod_df_mex, 'Non-urban', 'Urban')
# moderator_p(mod_df_mex, 'Village', 'Non-village')

```

```{r mod-est-mex, fig.cap = 'Moderators of the difference in PISA scores between 0.5 generation and Mexican-born adolescents. All estimates come from OLS models that adjust for the controls specified in the data section, cluster standard errors at the school level, and incorporate sampling weights.'}
mod_df_mex %>% 
  mutate(sample = factor(sample, levels = unique(mod_df_mex$sample))) %>%
  ggplot(aes(x = sample, y = Estimate, color = Outcome)) +
  geom_point(position = position_dodge(0.2)) +
  geom_errorbar(aes(ymin = Estimate - 1.96*se, 
                    ymax = Estimate + 1.96*se),
                width = 0, alpha = 1, position = position_dodge(0.2)) +
  geom_hline(yintercept = 0) +
  labs(x = '', y = 'Difference in scores for 0.5 generation'
       #title = 'Across moderators, the 0.5 generation performs as well or better than local Mexican students'
       ) +
  theme(axis.text.x=element_text(angle=-15),
        legend.justification=c(0,0),
        legend.position=c(0.175,.02)) 

```

The next analyses consider possible moderators of these effects. How do results vary by gender, age at migration, and rural vs. urban locality? Generally, girls tend to achieve higher scores than boys [@buchmann_2008], and the advantage for immigrant girls may be even higher [@dronkers_2014_migrant]. Thus we might expect girls of the 0.5 generation to have an easier time adjusting to life in Mexico. The first panel of Figure \@ref(fig:mod-desc-mex) shows that the proportions of girls in the 0.5 generation and local Mexican samples are nearly identical. Does the academic performance of boys and girls of the 0.5 generation differ? The first estimates in Figure \@ref(fig:mod-est-mex) show the difference between girls of 0.5 generation and Mexican-born girls, derived from OLS models with the same control variables and standard error procedures as for the full sample above. Corresponding estimates for boys follow. Except for math, the 0.5-generation advantage for girls is greater than that for boys, but differences between genders are not statistically significant. Both groups achieve scores at least as high as those of Mexican-born adolescents.  

Worldwide, PISA scores tend to be lower in rural areas [@sullivan_2018_comparison; @echazarra_2019_learning]. @hamann_2021_what claim that the 0.5 generation is more likely to live in rural areas, where relative paucity of resources may contribute to disadvantage. The final set of estimates in Figure \@ref(fig:dim-mex) showed that including a measure of rurality does not change estimates of overall score disparities. But location could still moderate results. What proportion of the children in this sample live in rural areas, and how does achievement vary between rural and urban areas? PISA provides five possible labels for "school community": village, small town, town, city, or large city. I test two possible dichotimizations: village, small town, and town vs. city or large city, and -- in a stricter test of rural disadvantage -- village vs. the other categories.  

The second panel of Figure \@ref(fig:mod-desc-mex) partially corroborates @hamann_2021_what: the 0.5 generation tends to live in somewhat less urban areas than the general population of Mexican children. However, the`    proportions in villages and large cities are virtually identical. Figure \@ref(fig:mod-est-mex) shows how the difference between the 0.5 generation and locals varies by locality. Contrary to expectations, score disparities do not vary by rurality. Point estimates in non-urban, urban, village, and non-village localities do not vary greatly, and differences between them are not statistically significant.  

Finally, I consider age at migration as a potential moderator. @despagne_2019_adaptation suggest that challenges faced by the 0.5 generation tend to fade with time. Furthermore, children who migrate at younger ages tend to score higher on achievement tests [@hermansen_2017; @lemmermann_2018]. Are the results reported above due to a large proportion of children who migrate at a young age? The right-most panel in Figure \@ref(fig:mod-desc-mex) shows that a high proportion of these children migrated to Mexico at a young age. In fact, a full `r with(age_arrival_df, prop[age_arrival == 0]) * 100` percent of the sample migrated to Mexico before the age of 1. Figure \@ref(fig:mod-est-mex) explores two possible divisions of arrival age, at 5 and 10 years. According to the figure, these age cut-offs do not make a difference. Whether these children migrate at a young or older age, they tend to perform as well or better than locals on PISA tests. Throughout the analysis of moderators, the math score advantage remains strong and significant, and point estimates never show a negative disparity for any subject.  








## Dissimilation from the U.S. Context

We now turn to comparisons between the 0.5 generation in Mexico and children of Spanish-speaking immigrants in the U.S. This pseudo-control group allows us to address the counterfactual question: what would have happened to these children had they not migrated to Mexico? How have they dissimilated from their counterparts in the U.S.? Descriptive statistics in Table \@ref(tab:stats) shows that although the 0.5 generation achieves somewhat higher scores than their Mexican-born peers, the U.S. comparison group performs much higher.  

```{r dim-us, results = 'hide', fig.height = 3.5, fig.cap = "Difference-in-means (DIM), OLS, and coarsened exact matching (CEM) estimates, comparing children of return migrants in Mexico to children of Spanish-speaking immigrants in the U.S. Error bars represent 95% asymptotic confidence intervals. OLS and CEM models adjust for parents' education, cultural possessions, home educational resources, age, ECEC, gender, and survey year. All models cluster standard errors at the school level and incorporate senate weights."}
dim_fig_us <-
  bind_rows(rubin(pisa_mex_us, 'DIM', weights = 'senate_weight'),
          rubin(pisa_mex_us, 'OLS (pre-migration)', 
                'mom_ed + dad_ed + female + early_ed +cultural_pos + home_ed + age + year',
                weights = 'senate_weight'),
          rubin(pisa_mex_us, 'OLS (pre- & post-migration)',
                covariates = 'mom_ed + dad_ed + female + early_ed +
                cultural_pos + home_ed + age + year + 
                wealth + home_pos + ict_res + escs + parent_isei', 
                weights = 'senate_weight')
          ) %>%
  mutate(Outcome = recode_factor(Outcome,
                                 'read' = 'Reading',
                                 'math' = 'Math',
                                 'scie' = 'Science'),
            sample = factor(sample, 
                            levels = c('DIM', 'OLS (pre-migration)', 'OLS (pre- & post-migration)')))

dim_fig_us %>%
  ggplot(aes(x = sample, y = Estimate, color = Outcome)) +
  geom_point(position = position_dodge(0.2)) +
  geom_errorbar(aes(ymin = Estimate - 1.96*se, ymax = Estimate + 1.96*se),
                width = 0, alpha = 1, position = position_dodge(0.2)) +
  geom_hline(yintercept = 0) +
  labs(x = 'Method', y = '') +
  theme(#axis.text.x=element_text(angle=-15),
        legend.justification=c(1,0), 
        legend.position=c(.5,.05))
```

Figure \@ref(fig:dim-us) more clearly presents the disparities. Unadjusted difference-in-means estimates show stark negative differences: `r with(dim_fig_us, Estimate[sample == 'DIM' & Outcome == 'Reading'])` in reading, `r with(dim_fig_us, Estimate[sample == 'DIM' & Outcome == 'Math'])` in math, and `r with(dim_fig_us, Estimate[sample == 'DIM' & Outcome == 'Science'])` in science. These amount to the 0.5 generation achieving math scores one-fifth of a standard deviation lower than their U.S. counterparts, and reading and science disparities are closer to half of a standard deviation. Despite being star students in Mexico, these children struggle on PISA exams much more than children of Spanish-speaking immigrants in the U.S.  


```{r mex-us-compare, fig.cap = 'Histograms comparing the family background of 0.5 generation to the chilren of Spanish-speaking immigrants in the U.S. in PISA 2012, 2015, and 2018. Estimates incorporate sampling weights.'}
plot_cat <- function(var_name, title){
  pisa_mex_us %>%
      mutate(treat = ifelse(treat == 1, '0.5 Generation', 'U.S. Spanish-Speaking')) %>%
      filter(!is.na(!!sym(var_name))) %>%
      group_by(treat, !!sym(var_name)) %>%
      count(wt = senate_weight) %>%
      group_by(treat) %>%
      mutate(prop = n /sum(n)) %>%
      ggplot(aes(x = !!sym(var_name), y = prop, color = treat, fill = treat)) +
      geom_col(position = 'dodge') +
      labs(x = '', y = '', 
           title = title)
}

plot_cont <- function(var_name, title){
   pisa_mex_us %>%
      mutate(treat = ifelse(treat == 1, '0.5 Generation', 'U.S. Spanish-Speaking')) %>%
      ggplot(aes(x = !!sym(var_name), color = treat, fill = treat)) +
      geom_histogram(aes(y=..density..,
                     weight = senate_weight),
                     position = 'dodge') +
  labs(x = '', y = '', title = title)
}

plot_cat('early_ed', 'Early Childhood Education') + 
  plot_cat('parent_ed_years', "Parent's Years of Education") + 
  scale_x_continuous(breaks = unique(pisa_mex_us$parent_ed_years)) +
  plot_cont('wealth', 'Wealth Composite')  +
  plot_cont('parent_isei', 'Parent\'s Occupation (ISEI)') + 
  plot_layout(nrow = 2, guides = 'collect')  & theme(legend.position = 'bottom')


years_df <- as_survey_design(pisa_mex_us, ids = school_id, weights = 'senate_weight') %>%
  group_by(treat) %>%
  summarize(survey_mean(parent_ed_years))

isei_df <- as_survey_design(pisa_mex_us, ids = school_id, weights = 'senate_weight') %>%
  group_by(treat) %>%
  summarize(survey_mean(parent_isei, na.rm = T))
```

Are such large disparities due to selection into migration? Figure \@ref(fig:mex-us-compare) compares histograms of family attributes of the two samples. The top row shows two measures of pre-migration characteristics. First, the 0.5 generation is more likely to have been in early childhood education, and for longer. The next panel compares  parents' highest years of education, showing that the 0.5 generation is likelier to have a parent with more years of education -- `r years_df[2,2]` years compared to the comparison group's `r years_df[1,2]` -- and also more likely to have a parent with a college degree. In this sense, the 0.5 generation appears to be *positively selected*: they are more advantaged than their counterparts who remain in the U.S. This contradicts the negative selection hypothesis.  

Hence we would expect that controlling for pre-migration characteristics will *not* account for disparities in PISA scores. As shown in Figure \@ref(fig:dim-us), an OLS model that adjusts for these characteristics estimates slightly smaller gaps, but they remain for all three subjects.  

Since selection into migration on these measured characteristics does not account for disparities, could the post-migration experience play a role? The second row of Figure \@ref(fig:mex-us-compare) presents two measures of post-migration attributes. The bottom-left panel shows a composite measure of family wealth, based on household possessions. I have scaled it to have a global mean of 0 and standard deviation of 1. Despite their pre-migration advantages, the 0.5 generation has less material assets than the U.S. comparison group. The bottom-right panel presents the parents' highest ISEI. The parents of the 0.5 generation are somewhat more likely to be employed in more prestigious, less manual labor. The education advantage enjoyed by parents of the 0.5 generation carries over to their occupation in Mexico, but does not translate to comparable measures of wealth.  

The final set of estimates in Figure \@ref(fig:dim-us) adjusts for pre- and post-migration characteristics. Estimated disparities become even more negative, although they are not significantly different from the DIM estimates. This suggests that it is neither selection nor the post-migration material experience of the 0.5 generation that accounts for their lower achievement compared to the U.S. Rather, it is likely that the lower resources of Mexican schools as well as the stress of adapting to an unfamiliar society are the contributing factors.  

```{r mod-est-us-mods}
controls = '+ mom_ed + dad_ed + female + early_ed + cultural_pos + home_ed + age + year'

mod_df_us <- bind_rows(
  rubin(filter(pisa_mex_us, female == 1), 'Girls', covariates = controls),
  rubin(filter(pisa_mex_us, female == 0), 'Boys', covariates = controls),
  rubin(filter(pisa_mex_us, non_urban == 1), 'Non-urban', covariates = controls),
  rubin(filter(pisa_mex_us, non_urban == 0), 'Urban', covariates = controls),
  rubin(filter(pisa_mex_us, village == 1), 'Village', covariates = controls),
  rubin(filter(pisa_mex_us, village == 0), 'Non-village', covariates = controls),
  rubin(filter(pisa_mex_us, age_arrival < 5 | treat == 0), 'Under 5', covariates = controls),
  rubin(filter(pisa_mex_us, age_arrival >= 5 | treat == 0), '5 and older', covariates = controls),
  rubin(filter(pisa_mex_us, age_arrival < 10 | treat == 0), 'Under 10', covariates = controls),
  rubin(filter(pisa_mex_us, age_arrival >= 10 | treat == 0), '10 and older', covariates = controls)
)

# moderator_p(mod_df_us, 'Girls', 'Boys')
# urban_us_p <- moderator_p(mod_df_us, 'Non-urban', 'Urban')[,4]
# village_us_p <- moderator_p(mod_df_us, 'Village', 'Non-village')[,4]

# rubin_means(filter(pisa_mex_us, non_urban == 0), labels = c('Mexico', 'U.S.')) 
# rubin_means(pisa_mex_us, labels = c('Mexico', 'U.S.')) 
```

```{r mod-est-us, fig.cap = 'Moderators of the difference in PISA scores between 0.5 generation and children of Spanish-speaking immigrants in the U.S. All estimates come from OLS models that adjust for the controls specified in the data section, cluster standard errors at the school level, and incorporate sampling weights.'}
mod_df_us %>% 
  mutate(sample = factor(sample, levels = unique(mod_df_us$sample))) %>%
  ggplot(aes(x = sample, y = Estimate, color = Outcome)) +
  geom_point(position = position_dodge(0.2)) +
  geom_errorbar(aes(ymin = Estimate - 1.96*se, 
                    ymax = Estimate + 1.96*se),
                width = 0, alpha = 1, position = position_dodge(0.2)) +
  geom_hline(yintercept = 0) +
  labs(x = '', y = 'Difference in scores for 0.5 generation'
       #title = 'Across moderators, the 0.5 generation in Mexico underperforms compared to their U.S. counterparts'
       ) +
  theme(axis.text.x=element_text(angle=-15),
        legend.justification=c(0,0),
        legend.position=c(0.175,.02)) 
```

The final set of analyses examines factors that moderate the effect of migration. Figure \@ref(fig:mod-est-us) presents the same set of moderators as Figure \@ref(fig:mod-est-mex), fitting the "OLS (pre-migration)" model to subsets of the data. First, effects differ little by gender: girls and boys in the 0.5 generation in Mexico achieve lower scores than daughters and sons of Spanish-speaking immigrants in the U.S., respectively, and differences between them are not statistically significant.  

The urban-rural divide shows greater disparities, corroborating the expectations of @hamann_2021_what regarding the potential disadvantage of rural areas. The 0.5 generation in non-urban areas obtains PISA scores that are significantly lower than their U.S. counterparts in non-urban areas, and disparities between villages and non-villages are even more substantial and statistically significant. The 0.5 generation residing in villages obtain reading and science scores more than on standard deviation below their U.S. counterparts in rural areas, and math scores half of a standard deviation below. Notably, expected PISA scores for the 0.5 generation in Mexican urban areas are indistinguishable from their urban counterparts in the U.S. This is not due to U.S.-specific urban disadvantage; in the U.S., children of Spanish-speaking immigrants in urban areas perform better than those in rural areas. Although the 0.5 generation does not perform worse that similar Mexican children living in the same type of locality, students in rural areas in Mexico face significant disadvantage compared to their counterparts in rural areas in the U.S.  

Finally, we see little variation in effect by age of migration. If we restrict the analysis to children who migrated to Mexico below the age of 5 or 10, estimated disparities are just as negative as for children who migrated at older ages. Students in Mexican schools obtain lower PISA scores that children in the U.S.  



# Discussion and Conclusion

This paper aimed to quantify the educational situation of U.S.-born children of return migrants in Mexico. Previous research on this "0.5 generation" [@zuniga_2018_generation] has presented a mixed picture: although these children face stigma, language difficulties, and bureaucratic hurdles, some scholars have documented the advantages bestowed by bicultural facility and time in relatively well resourced U.S. schools. To help settle this empirical question, I presented two types of comparisons using PISA data. First, in the tradition of assimilation and integration studies, I compared the 0.5 generation to the general population of Mexican 15-year-olds. Second, I incorporated a dissimilation framework by comparing them to a pseudo-control group: children of Spanish-speaking immigrants in the U.S. While the first comparison presents the descriptive perspective of Mexican society, the second gets closer to estimating a causal effect of migration, or the scores these students would have obtained had their families not returned to Mexico. In addition, models that control for pre-migration attributes allow explicit examination of the effect of immigrant selection.  

In the comparisons with Mexican children, I find support for a *star student hypothesis* rather than *rough re-entry*: the 0.5 generation performs just as well Mexican children on reading and science PISA tests, and they outperform locals in math by one-fifth of a standard deviation. These effects remain nearly unchanged in models that control for both pre- and post-migration attributes, and the potential moderators of gender, urban or rural locality, and age at migration make little difference. Comparisons with the U.S. sample, however, tell a very different story. Juxtaposed with this pseudo-control group, children of Mexican return migrants obtain much lower scores, ranging from one-quarter to one-half of a standard deviation. Contrary to general work on Mexican return migrants, the parents of these adolescents are positively selected on education and work in slightly more prestigious occupations than their U.S. counterparts. 

In sum, more advantaged family resources do not prevent a near-total assimilation to the educational outcomes of Mexican students. Although the bottom-left panel of Figure \@ref(fig:mex-us-compare) suggests that lower wages in Mexico result in material deprivation relative to similar children in the U.S., models that control for family wealth estimate larger rather than smaller disparities. The most likely contributing factor is Mexican schools, which receive far fewer resources than those in the U.S. In 2014, Mexico spent 2,000 USD per pupil, while the U.S. spent 18,000 USD [@santibanez_2021_contrasting, p. 25]. Even when adjusted for purchasing power parity, this funding differential results in less resources for learning. Also, many teachers in Mexico must navigate hectic hours, often shifting between schools and sets of students in the middle of each day. This strain on teachers negatively impacts student achievement.  

  


<!-- PISA excludes 15-year-olds who have been unable to enroll in school, and these may be among the most disadvantaged of the 0.5 generation. -->
<!-- Differences from previous studies could be due to a number of reasons that future research should attempt to disentangle. -->

This study suggests a number of future directions in research on the 0.5 generation.  First, this study uses a more narrowly defined group than much previous research: studies of the 0.5 generation in Mexico have grouped together students born in the U.S. and those born in Mexico who migrate to the U.S. at an early age [@zuniga_2018_generation; @zuniga_2018_ninas; @zuniga_2021_children]. Although identifying such students is not possible in PISA data, future research should assess the achievement of of this group as well. Another reason for differences could be age at examination. PISA is administered to 15-year-old students, while studies such as the large survey by @zuniga_2018_ninas cover a range of ages. Perhaps children at younger ages are more susceptible to disadvantage; future research should assess the achievement of younger members of the 0.5 generation. Finally, this study has not been able to differentiate between voluntary and involuntary return migration. Since the stress and hardship of deportation are likely to negatively impact academic achievement, future work should attempt to differentiate the effects of these different types of movement.  

This study constitutes an important corrective to literature on the 0.5 generation. First, by showing that the educational situation of these students is one of advantage rather than disadvantage when compared to other students in Mexico, this study contradicts the majority of previous research on this group that highlights their academic struggles. Second, studies that focus on only one country fail to capture the importance of institutional context. The U.S. comparisons presented here show that migration from more- to less-advantaged educational contexts can entail unfortunate consequences for children's educational outcomes. Since many of these returns result from deportation of parents, this paper documents yet another way that U.S.-citizen children of undocumented immigrants are harmed by punitive immigration policy. 





\newpage

# References
